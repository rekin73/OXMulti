<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Kółko i krzyk</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        #canvas {
            border: 1px solid black;
        }
    </style>
    <script>
        var width = 10;
        var height = 5;
        var widthSquare;
        var plane = [];
        class square {
            constructor(Y, X, width) {
                this.x = X;
                this.y = Y;
                this.w = width;
            }
        }
        document.addEventListener("DOMContentLoaded", function (event) {
            function isIntersect(point, circle) {
                return Math.sqrt((point.x - circle.x) ** 2 + (point.y - circle.y) ** 2) < circle.radius;
            }

            function collides(rects, x, y) {
                //https://stackoverflow.com/questions/5014851/get-click-event-of-each-rectangle-inside-canvas
                var isCollision = false;
                for (var i = 0, len = plane.length; i < len; i++) {
                    for (var j = 0, hig = plane[i].length; j < hig; j++)
                        var left = plane[i][j].x, right = rects[i][j].x + rects[i][j].w;
                    if (right >= x
                        && left <= x
                        && bottom >= y
                        && top <= y) {
                        isCollision = rects[i][j];
                    }
                }
                return isCollision;
            }
            canvas.addEventListener('click', function (e) {
                console.log('click: ' + e.offsetX + '/' + e.offsetY);
                var rect = collides(plane, e.offsetX, e.offsetY);
                if (rect) {
                    console.log('collision: ' + rect.x + '/' + rect.y);
                } else {
                    console.log('no collision');
                }
            }, false);
            canvas = document.getElementById("canvas");
            var ctx = canvas.getContext("2d");
            canvas.width = 0.99 * window.innerWidth;
            canvas.height = 0.99 * window.innerHeight;
            //resize
            window.addEventListener("resize", function () {
                console.log("resize" + window.innerWidth + "," + window.innerHeight);
                var canvas = document.getElementById("canvas");
                canvas.width = window.innerWidth - 2;
                canvas.height = 0.99 * window.innerHeight - 2;
                drawSquare(width, height);
            });
            function drawSquare(wdh, hgh) {
                widthSquare = canvas.width / wdh;
                var sqrWidth = canvas.width / wdh;
                var sqrHeight = canvas.height / hgh;
                var sqrRealWidth = function (W, H) {
                    if (W > H) { return H } else { return W };
                }
                var sqr = sqrRealWidth(sqrWidth, sqrHeight)
                console.log(sqrRealWidth(sqrWidth, sqrHeight))

                for (var i = 0; i < wdh; i++) {
                    plane[i] = [];
                    for (var j = 0; j < hgh; j++) {
                        ctx.strokeRect(i * sqr, j * sqr, sqrRealWidth(sqrWidth, sqrHeight), sqrRealWidth(sqrWidth, sqrHeight));
                        plane[i][j] = new square(i * sqr, j * sqr, widthSquare);
                        //plane[i][j]=0;

                    }
                }
                console.log(plane)
            }

            drawSquare(width, height);
            console.log(plane);
        });
    </script>
</head>

<body>
    <canvas id="canvas"></canvas>
</body>

</html>